language: python
python: '3.6'
cache:
  yarn: true
  pip: true
  directories:
    - node_modules
install:
  - yarn install
  - yarn run build
  - pip install .
script:
  - echo "no tests implemented"
deploy:
  # provider: npm doesn't work for some reason :(
  - provider: script
    skip_cleanup: true
    script: "cp .npmrc.template $HOME/.npmrc && npm publish"
    on:
      tags: true
      repo: cognitive-class-labs/jupyterlab-media-capture
  - provider: pypi
    skip_cleanup: true
    server: https://na.artifactory.swg-devops.com/artifactory/api/pypi/apset-pypi-local
    user: james.reeve@ibm.com
    password:
      secure: nXnFy9W0aNVNfQlQC52qNqPrh9ucW/Hz1RU57q/n+porzbRVsJLjjtwPqh9i+ReK5ohJaPHZIHq4xv6BfY6+AMjMl1tbAUJRrkXwZICjj5hOFWZNY4S1NrJ+TMKjGgqUmU4qUwgJ6a7U2YDdPSys+ccAoy3QNFpiTWJkdh18zvWKJDPRE7CDS3m7974UY9w/i1/Yct5meJJnjHoTbSas37SLv2vxat3mJwSorA+3MYkUUPlKILcGR84K3i26yF7ZMw+Yv4koFnowyqwzZJ2grx0mtkiV4v/xcznd/IsChhPtBScMtSg8pfErHefooP4nWX2B93wUex9GjZcSX08iSy3Zd4tfOKRS/dLCLjk8Y7AW4eHV+ZH9SwUBylnzvFWw+6ljJgMCnmZ3LkPihez7pUTgOkOjXSn+jXSlJZXD8z7+U4GiptgEsHPeq84NI/JnQ25hlwdx69fgk8VH8IDSe3QZPksk32p6y2wIk1tLzCnGMfodsnKopo2oi48PWfmvFoJmOTJ8Q3B17Te7nBd4r4gTImYtMYB1PJWlletXjjS9COmm4/quGPMX4T7GWmqwqocyWGvdw318i6GISVZk+OJ2AmRRolzFeYkeQ7XcH2t8vahpTNKguZv1dNeBlnLJIR7zuVZrKBbkwixDnRYwKwiGyHMG2UwdjnRonRH33Vc= # pragma: whitelist secret
    on:
      tags: true
      repo: cognitive-class-labs/jupyterlab-media-capture
notifications:
  email: false
  slack:
    on_pull_requests: false
    on_failure: "change"
    on_success: "change"
    secure: "Mh4vj0L2g4QEvB/RHTvmx6wXW7JtdJ2yoyEL4FdQX849VvcJb+Jsm6ZkbzDryBOCIeUnvFDflOmj7M0ubEqCatp4cl7FYmql6NZndKJgWLplW5SOtCSw0u8frQnuNyI2KOYKwB7y76kXUfzmep8aahYzZvyI5/Rx0HfF619bgmw/kAghy4Tenu2LNmrpKapys2nZHpYTlxEGGrd9ALEUMWdgiBIhBtHOltlzdOhHY4ryBTP9dVjqrxBW23ZXh1WzyZ9Qc4b8obeA30E9nWrgSf1zuFg83GgYoZqu2T6y3VqUvg1z2ARjakTdDn1FWEVAkODUbb1JbkGsB3Sndo4jbyGCxeXvqgo1dsWtA4PUzVX0xix+90SLyewuP7r/+hbzWpuU6KtmJrAGd7uFy+0TvdfZCKJNOxZkNSYr7+ZuCgfRw3RnhmInqIveJvLWl/Hw4eh2v5VLyjeXhJWmJneXyuHDmlsSpijeL2vNq3lYTRX6Bg3PV47nVpwZ6qKLsLAVJgJuwQ8G9GsgPkqRPBC+zPnM9x63E57AIrfkdx1gH73onog/qcLYP4ECmmWjYM/6bNbDtu6iUCXvswea/dfr9aYQIQs5iSiP9xts2Bt0CBic7OZ7OQw559z9rPU3xwVFRb4ah0F8wiLb9Od2GkQi+7Vnf/rmSJAGTgTKfAfeXIs=" # pragma: whitelist secret
